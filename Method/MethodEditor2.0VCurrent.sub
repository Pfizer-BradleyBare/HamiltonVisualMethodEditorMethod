// {{{ 2 "SubmethodForwardDeclaration" ""
private function ChooseMethodFile(  ) variable ;
private function FinishRun(  ) void ;
private function RunMakerScript( variable Excel_File_Path, variable Start_Pos, variable RunType ) void ;
function OnAbort(  ) void ;
// }} ""
// {{{ 5 "OnAbort" "Begin"
function OnAbort(  ) void {
// }} ""
// {{ 5 "OnAbort" "InitLocals"
// }} ""
// {{{ 242 1 0 "98236fad_2587_477e_b5639f6ab420d964" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
FinishRun();
// }} ""
// {{ 243 1 0 "3533cb01_4b07_4c29_96610b3c08d8e43d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 244 1 0 "77ccb08e_fdbd_4f2f_afe2b1a6096fccf3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
HEATER::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 245 1 0 "c0e5df37_e972_4501_bb7b4ff474c11fe1" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
LID::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 246 1 0 "5f1ce07e_4331_4018_a8a01fdbb8705e33" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
NOTIFY::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 247 1 0 "d9399fc1_215f_4b22_a72bc62c51ed82cf" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
PIPETTE::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 248 1 0 "fb36b1b3_69af_405c_9f208f38aa61807e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
STATUSUPDATE::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 249 1 0 "22d8c32e_c798_406d_b34576dc7e602b10" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
TIMER::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 250 1 0 "887e05ab_b83a_4c74_bafcd4d71e043485" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
TRANSPORT::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 251 1 0 "e32db368_3218_4ae6_919a3368440c607a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
VACUUM::DeInit(ML_STAR, Translate(""));
// }} ""
// {{{ 252 1 0 "28fbc5cc_02ee_488d_8d885154089df4cc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
MAGNETIC_BEADS::DeInit(ML_STAR, Translate(""));
// }} ""
// {{ 253 1 0 "3533cb01_4b07_4c29_96610b3c08d8e43d" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "OnAbort" "End"
}
// }} ""
// {{{ 5 "RunMakerScript" "Begin"
private function RunMakerScript( variable Excel_File_Path, variable Start_Pos, variable RunType ) void {
// }} ""
private variable Command_Base;
private event _Temp;
private variable __Temp;
// {{ 5 "RunMakerScript" "InitLocals"
// }} ""
// {{{ 231 1 0 "e0a24387_7847_4142_b8e5fe2ddee57d67" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("******************************************************************"), Translate(""));
// }} ""
// {{{ 232 1 0 "bea077e9_1754_4675_b88675099fdf6a63" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("************ Running Method Maker Script *****************"), Translate(""));
// }} ""
// {{{ 233 1 0 "f72a103e_8eb4_4497_874722f1ff853818" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("******************************************************************"), Translate(""));
// }} ""
// {{{ 234 1 0 "f15ef209_d39c_4409_b42de85ed2a5fed0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
PythonRootPath = SCRIPT::GetPythonRootPath();
// }} ""
// {{{ 235 1 0 "f884c049_bd62_4985_b564fd8fe330809a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
ScriptRootPath = SCRIPT::GetScriptRootPath();
// }} ""
// {{{ 236 1 0 "7fa1fda7_8b27_43ed_b9c8f82d0306dc64" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Command_Base = StrConcat12(Translate("C:\\windows\\system32\\cmd.exe /K "), Translate("\"\""), PythonRootPath, Translate("\\python.exe\" "), Translate(" \""), ScriptRootPath, Translate("\\MethodMaker.py\""), Translate(""), Translate(""), Translate(""), Translate(""), Translate(""));
// }} ""
// {{{ 237 1 0 "30968835_c654_4eaa_95848e1707419917" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
Command_Base = StrConcat12(Command_Base, Translate(" "), Translate("\""), Excel_File_Path, Translate("\""), Translate(" "), Start_Pos, Translate(" "), RunType, Translate("\""), Translate(""), Translate(""));
// }} ""
// {{{ 238 1 0 "8c0f1801_12a1_43be_b08c208883a458cd" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Command_Base, Translate(""));
// }} ""
// {{{ 239 1 0 "f75f2b72_4f94_4a99_a395abe5ea2f6f50" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
_ = Util::AsyncShell(Command_Base, 2, _Temp, __Temp);
// }} ""
// {{ 240 1 0 "1ceb1851_8590_4e71_ace42325e953bdfa" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 5 "RunMakerScript" "End"
}
// }} ""
// {{{ 5 "ChooseMethodFile" "Begin"
private function ChooseMethodFile(  ) variable {
// }} ""
private variable loopCounter2;
// {{ 5 "ChooseMethodFile" "InitLocals"
// }} ""
// {{{ 202 1 0 "9431f1be_2d3c_47a2_b315063865b4b1f6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("******************************************************************"), Translate(""));
// }} ""
// {{{ 203 1 0 "ea4eab91_bc63_4ccf_938f491f62599306" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("******************* Selecting Method File ********************"), Translate(""));
// }} ""
// {{{ 204 1 0 "5c443bd1_da23_4f94_a5fa32c047998aed" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("******************************************************************"), Translate(""));
// }} ""
// {{{ 205 1 0 "5f613e7a_e5ac_474f_bc1d0d3de556e63c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
AswStandardDialogs::Initialize();
// }} ""
// {{ 206 1 0 "e985a1d5_a30d_4f92_9927a9b4153b6ea1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
Out = Translate("");
// }} ""
// {{ 207 1 0 "b00a760d_85c9_473c_9355897b3759fde5" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter2 = 0;
while (Out == "")
{
loopCounter2 = loopCounter2 + 1;
// }} ""
// {{{ 208 1 0 "95cb54be_3dff_49fc_814c6b3b09d56d2c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
AswStandardDialogs::FileBrowserDialog(Translate("Choose File"), 0, 0, 0, Translate("Please Choose a Method Maker Excel File"), 1, Translate(""), 0, Translate(""), Out);
// }} ""
// {{ 209 1 0 "35ad6372_cb2e_4b03_b4864cb9ce06dbf7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (Out == "")
{
// }} ""
// {{{ 210 1 0 "d6cb1fff_1e9c_4937_81f740b3cf1067f8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
AswStandardDialogs::MessageDialog(Translate("Error"), 1, 0, 0, 0, 0, Translate("File not selected... Please select a file from the dialog."));
// }} ""
// {{ 211 1 0 "35ad6372_cb2e_4b03_b4864cb9ce06dbf7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 212 1 0 "b00a760d_85c9_473c_9355897b3759fde5" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 213 1 0 "0e0e789b_3c7b_42fd_9cc9f29075e0fee0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
AswStandardDialogs::Terminate();
// }} ""
// {{{ 214 1 0 "619450f6_3b9c_42aa_aa2d4586fda395cc" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (Out);
// }} ""
// {{{ 5 "ChooseMethodFile" "End"
}
// }} ""
// {{{ 5 "FinishRun" "Begin"
private function FinishRun(  ) void {
// }} ""
private variable FilePath;
private variable File;
private variable loopCounter3;
// {{ 5 "FinishRun" "InitLocals"
// }} ""
// {{ 216 1 0 "ef5e6f42_90af_49c9_ae1b4bb0192be26c" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 217 1 0 "039bb73d_0f7b_468a_ac5af78662d2bddf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
FilePath = StrConcat2(ScriptRootPath, Translate("\\CommunicationFolder\\Command.txt"));
// }} ""
// {{{ 218 1 0 "640600fb_5940_4e92_bed664e8e09e5af9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
File = FilSearchPath(FilePath);
// }} ""
// {{ 219 1 0 "cd0c996a_7f47_4c65_bf5825863eac49f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (File != "")
{
// }} ""
// {{{ 220 1 0 "9c9e203c_dd2a_499d_89af4b552c87cacd" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetCommand(Command);
// }} ""
// {{ 221 1 0 "cd0c996a_7f47_4c65_bf5825863eac49f2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 222 1 0 "fd5b68b1_997e_473b_8d1c9aed6162a4f6" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::WriteResponse(Translate("Abort"));
// }} ""
// {{ 223 1 0 "ef5e6f42_90af_49c9_ae1b4bb0192be26c" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 224 1 0 "d4f6dd62_ab95_48e1_af3b3f01a8c3e9bd" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{ 225 1 0 "84291bad_e5b3_4346_aa59ee981263b40b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (Command.ElementAt( 1 -1) != "END")
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{{ 226 1 0 "25801667_8c34_4be2_84a361142d4d8503" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::GetCommand(Command);
// }} ""
// {{{ 227 1 0 "b5e3e224_191c_43d6_abd53bacdfe08e12" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
COMMANDS::WriteResponse(Translate("Abort"));
// }} ""
// {{ 228 1 0 "84291bad_e5b3_4346_aa59ee981263b40b" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 229 1 0 "d4f6dd62_ab95_48e1_af3b3f01a8c3e9bd" "{586C3429-F931-405f-9938-928E22C90BFA}"

// }} ""
// {{{ 5 "FinishRun" "End"
}
// }} ""
/* {{ 2 "SubmethodInsertLine" "" */ // }} ""
// $$author=BAREB$$valid=0$$time=2022-01-10 15:15$$checksum=a008eb01$$length=084$$